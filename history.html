<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>QuickBurn HIIT - 90 Day History</title>
    <style>
        :root {
            --bg: #121212; --card-bg: #1e1e1e; --green: #4CAF50; --red: #f44336; 
            --blue: #2196F3; --text: #ffffff; --text-dim: #888888; --header-bg: #1a1f2c; 
        }
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            background-color: var(--bg); color: var(--text); margin: 0; padding: 0;
        }
        .header {
            background: var(--header-bg); padding: 15px; display: flex; 
            align-items: center; border-bottom: 1px solid #2d3446; position: sticky; top: 0;
        }
        /* Changed to cursor:pointer for better mobile feedback */
        .back-btn { 
            font-size: 30px; 
            color: var(--blue); 
            text-decoration: none; 
            padding-right: 20px; 
            font-weight: bold; 
            cursor: pointer;
        }
        .content { padding: 10px; max-width: 500px; margin: 0 auto; padding-bottom: 50px; }
        .history-month-header { color: var(--green); font-size: 20px; font-weight: bold; margin: 25px 0 10px 5px; border-bottom: 1px solid #333; padding-bottom: 5px; }
        .history-day-card { background: var(--card-bg); margin-bottom: 10px; padding: 15px; border-radius: 12px; display: flex; justify-content: space-between; align-items: center; border-left: 5px solid #333; }
        .history-day-card.active { border-left-color: var(--green); }
        .stat-main { font-weight: bold; color: var(--green); font-size: 18px; text-align: right; }
        .month-summary { background: #252525; padding: 15px; border-radius: 12px; margin: 20px 0; border: 1px dashed var(--green); }
        label { display: block; font-size: 11px; color: var(--text-dim); text-transform: uppercase; font-weight: bold; margin-bottom: 5px;}
    </style>
</head>
<body>
    <div class="header">
        <span onclick="history.back()" class="back-btn">&lsaquo;</span>
        <div style="font-weight: bold; color: var(--green);">90 DAY HISTORY</div>
    </div>
    <div class="content" id="history-content"></div>

    <script>
        function getHistory() { return JSON.parse(localStorage.getItem('jumpRopeHistory') || '{}'); }

        function renderMonthSummary(container, secs, cals) {
            const sum = document.createElement('div'); sum.className = 'month-summary';
            sum.innerHTML = `<label>Month Total</label><div style="display:flex; justify-content: space-between; font-weight: bold;"><span>${(secs / 60).toFixed(1)} Minutes</span><span style="color:var(--green)">${cals.toFixed(1)} Kcal</span></div>`;
            container.appendChild(sum);
        }

        function initHistory() {
            const history = getHistory(); const content = document.getElementById('history-content');
            content.innerHTML = ''; const today = new Date();
            let currentMonth = -1, mSecs = 0, mCals = 0;

            for (let i = 0; i < 90; i++) {
                const date = new Date(); date.setDate(today.getDate() - i);
                const dateKey = date.toISOString().split('T')[0];
                const dayData = history[dateKey] || { seconds: 0, calories: 0 };
                if (date.getMonth() !== currentMonth) {
                    if (currentMonth !== -1) renderMonthSummary(content, mSecs, mCals);
                    currentMonth = date.getMonth(); mSecs = 0; mCals = 0;
                    const header = document.createElement('div'); header.className = 'history-month-header';
                    header.innerText = date.toLocaleString('default', { month: 'long' }) + " " + date.getFullYear();
                    content.appendChild(header);
                }
                mSecs += dayData.seconds; mCals += dayData.calories;
                const card = document.createElement('div');
                card.className = `history-day-card ${dayData.seconds > 0 ? 'active' : ''}`;
                card.innerHTML = `<div class="day-info"><div>${date.getDate()} ${date.toLocaleString('default', { month: 'short' })}</div><div style="font-size:12px; color:var(--text-dim)">${date.toLocaleDateString('en-US', { weekday: 'long' })}</div></div><div class="day-stats"><div class="stat-main">${(dayData.seconds / 60).toFixed(1)} MIN</div><div style="font-size:12px; color:var(--text-dim); text-align:right;">${dayData.calories.toFixed(1)} KCAL</div></div>`;
                content.appendChild(card);
            }

            const resetCont = document.createElement('div');
            resetCont.style.cssText = "margin-top:40px; text-align:center;";
            resetCont.innerHTML = `<button onclick="confirmReset()" style="background:transparent; color:var(--red); border:1px solid var(--red); width:100%; font-size:12px; padding:15px; border-radius:10px; font-weight:bold;">CLEAR ALL WORKOUT DATA</button>`;
            content.appendChild(resetCont);
        }

        function confirmReset() {
            if (prompt("To delete history, type 'SURE':") === "SURE") {
                localStorage.removeItem('jumpRopeHistory');
                location.reload();
            }
        }

        window.onload = initHistory;
    </script>
</body>
</html>